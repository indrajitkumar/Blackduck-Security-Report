<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuration</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>

    </style>
</head>
<body>
<div class="d-flex">
        {% include 'left_panel.html' %}
        <div class="right-panel flex-grow-1 p-6">
            <div class="configuration-container">
                <h2>Document Revision History</h2>
                <form id="configurationForm" onsubmit="saveRevisionData(event)" class="mb-4">
                    <div class="form-group">
                        <label for="referenceNumber">Reference Number</label>
                        <input type="text" id="referenceNumber" name="referenceNumber" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="documentTitle">Document Title</label>
                        <input type="text" id="documentTitle" name="documentTitle" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="documentId">Document ID</label>
                        <input type="text" id="documentId" name="documentId" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="revision">Revision</label>
                        <input type="text" id="revision" name="revision" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="date">Date</label>
                        <input type="date" id="date" name="date" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="author">Author</label>
                        <input type="text" id="author" name="author" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="attendees">Attendees</label>
                        <textarea id="attendees" name="attendees" class="form-control" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="crReason">Reason</label>
                        <textarea id="crReason" name="crReason" class="form-control" required></textarea>
                    </div>
                    <h2>Terminology & Abbreviations</h2>
                    <div class="input-group mb-3">
                        <input type="text" id="term" placeholder="Term" class="form-control col-4 mr-2">
                        <input type="text" id="abbreviation" placeholder="Abbreviation" class="form-control col-4 mr-2">
                        <button type="button" onclick="addTerm()" class="btn btn-primary form-control col-2 mr-2">Add</button>
                    </div>
                    <ul id="termList" class="list-group mb-3"></ul>
                    <button type="submit" class="btn btn-primary">Save Configuration</button>
                </form>
            </div>
    </div>
</div>

<script>
    function loadContent(url) {
        fetch(url)
            .then(response => response.text())
            .then(data => {
                document.querySelector('.right-panel').innerHTML = data;
            })
            .catch(error => console.error('Error loading content:', error));
    }

    function addTerm() {
        const term = document.getElementById('term').value;
        const abbreviation = document.getElementById('abbreviation').value;

        if (term && abbreviation) {
            const li = document.createElement('li');
            li.textContent = `${term}: ${abbreviation}`;
            li.className = 'list-group-item';
            document.getElementById('termList').appendChild(li);

            document.getElementById('term').value = '';
            document.getElementById('abbreviation').value = '';
        } else {
            alert('Please fill in both fields.');
        }
    }

    function saveRevisionData(event) {
        event.preventDefault();

        const formData = new FormData(document.getElementById('configurationForm'));
        const termList = document.getElementById('termList').children;
        const terms = [];
        for (let i = 0; i < termList.length; i++) {
            terms.push(termList[i].textContent);
        }
        formData.append('terms', JSON.stringify(terms));

        fetch('/save_revision_data', {
            method: 'POST',
            body: formData
        })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    alert('Data saved successfully');
                } else {
                    alert('Failed to save data');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred while saving data');
            });
    }
</script>
<script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
