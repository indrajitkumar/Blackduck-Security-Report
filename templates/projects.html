<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Black Duck Projects</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="{{ url_for('static', filename='script.js') }}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
</head>
<body>
<div class="d-flex">
    {% include 'left_panel.html' %}
    <div class="right-panel flex-grow-1 p-4">
        <h2 class="mb-4 text-center">Software Product Security Vulnerability Report</h2>

        <!-- Project Selection Form -->
        <form id="projectForm" class="mb-4">
            <div class="row align-items-center">
                <!-- Project Selection -->
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="projects">Select a project</label>
                        <select id="projects" name="projects" class="form-control" onchange="getSelectedProject()">
                            <option value="" disabled selected>--Select--</option>
                            {% for project in projects %}
                                <option value="{{ project._meta.href.split('/')[-1] }}"
                                        data-name="{{ project.name }}">{{ project.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>


                <!-- Project Name with Version -->
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="newData">Enter project name with version</label>
                        <input type="text" id="newData" name="newData" class="form-control"
                               oninput="updatePlaceholder()">
                    </div>
                </div>

            </div>
        </form>
        {#        <!-- Selected Project Name -->#}
        {#        <h2 id="selectedProjectName" class="mb-4">Select a project to see its name here</h2>#}

        <div class="d-flex justify-content-between mb-4">
            <div class="btn-group" role="group">
                <button type="button" class="btn btn-primary" onclick="showTab('tab1')">Title Page</button>
                <button type="button" class="btn btn-primary" onclick="showTab('tab2')">Component Overview</button>
                <button type="button" class="btn btn-primary" onclick="showTab('tab3')">Analysis</button>
                <button type="button" class="btn btn-primary" onclick="showTab('tab4')">Document Revision History
                </button>
                <button type="button" class="btn btn-primary" onclick="showTab('tab5')">Abbreviations</button>
                <button type="button" class="btn btn-primary" onclick="showTab('tab6')">References</button>
            </div>
            <div class="flex-column">
                <input type="file" id="importExcel" class="btn btn-secondary" accept=".xlsx"
                       onchange="importExcelFile()">
                <button type="button" class="btn btn-primary" onclick="generateExcelReport()">Generate Excel
                    Report
                </button>

            </div>
        </div>

            <div id="tab1" class="tab active">
        <h2>Purpose</h2>
        <p>This document is used to report the product security analysis of vulnerabilities in software and hardware elements and parts (components), which are used in  &nbsp;<span id="placeholder">___________________</span>. This report is established during design to capture remaining vulnerabilities. As new security issues including vulnerabilities are continuously identified in software and hardware components, this report must be maintained during the entire lifecycle until End-of-Support, as part of post market obligations for both medical as well as non-medical products.

This document demonstrates the continuous analysis of security issues and new vulnerabilities and serves as a trigger for follow-up actions and as an input into the higher-level product security risk assessment to further assess specific vulnerabilities and/or a set of aggregated vulnerabilities within specific components.

This report uses the Software bill of materials (SBOM) document [REF-1] as one of its inputs. It captures the product-related vulnerability information, which originates from many sources such as information supplied by third party sources.</p>
        <h2>Scope</h2>
        <p>This document is applicable to all software and hardware components used in&nbsp; <span id="placeholder1">___________________</span>.
    </div>
            <div id="tab2" class="tab">
                <h2>Component Overview</h2>
                <table id="projectDataTable">
                    <thead>
                    <tr>
                        <th>Component name</th>
                        <th>Component version</th>
                        <th>Description</th>
                        <th>Support Status</th>
                    </tr>
                    </thead>
                    <tbody>
                    <!-- Data will be populated here -->
                    </tbody>
                </table>
            </div>
            <div id="tab3" class="tab">
                <h2>Analysis</h2>
                <table id="projectDataTable1">
                    <thead>
                    <tr>
                        <th>Review date (YYYY-MM-DD)</th>
                        <th>Component name</th>
                        <th>Component version</th>
                        <th>Vulnerability ID (e.g. CVE)</th>
                        <th>Description</th>
                        <th>Base score</th>
                        <th>Exploitability</th>
                        <th>Impact</th>
                        <th>Remediation status</th>
                        <th>Remediation comment</th>
                        <th>Severity rating</th>
                        <th>Update PSSD?</th>
                        <th>Manage Defect requested?</th>
                    </tr>
                    </thead>
                    <tbody>
                    <!-- Data will be populated here -->
                    </tbody>
                </table>
            </div>
            <div id="tab4" class="tab">
                <h2>Document Revision History</h2>
                <div id="revisionDataContainer">
                </div>
            </div>
            <div id="tab5" class="tab">
                <h2>Terminology & Abbreviations</h2>
                <div id="termListDataContainer">
                </div>
            </div>
            <div id="tab6" class="tab">
                <h2>References</h2>
                <div id="referencesDataContainer">
                </div>
            </div>

            <div class="footer mt-4">
                <p>&copy; 2024 PHDSI - HSCS. All rights reserved.</p>
            </div>
            <div class="loader" id="loader"></div>
        </div>
</div>
</body>
</html>